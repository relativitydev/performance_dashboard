USE [EDDSPerformance]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

PRINT N'Create procedure [eddsdbo].[LoadApplicationHealthSummary]'
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[eddsdbo].[LoadApplicationHealthSummary]') AND type in (N'P', N'PC'))
DROP PROCEDURE [eddsdbo].[LoadApplicationHealthSummary]
GO
-- =============================================
-- Author:		Murali Shesham
-- Create date: 08/31/2011
-- Description:	
-- 2012-05-30 : Ron @ Milyli : Altered to add new fields
-- 2013-02-15 : Ron @ Milyli : Added new TotalNRQCount (total non-relational queries)
-- =============================================
CREATE PROCEDURE [eddsdbo].[LoadApplicationHealthSummary]
	@ProcessExecDate DateTime 
AS
BEGIN
	SET NOCOUNT ON;


	Declare @SummaryMeasureDate DateTime
	Declare @MeasureDate Date
	Declare @MeasureHour Int
	Select @MeasureDate = Cast(@ProcessExecDate as Date) , @MeasureHour = DatePart(HH,@ProcessExecDate) 
	Select @SummaryMeasureDate = DATEADD(HH,@MeasureHour, CAST(@MeasureDate as Varchar(20)))

	IF EXISTS(Select 1 From eddsdbo.PerformanceSummary Where MeasureDate = @SummaryMeasureDate)
	BEGIN 
	  PRINT 'Cannot load data more than once in an hour'
			  UPDATE PS
			  SET LRQCount = LC.LRQCount,
				  NRLRQCount = LC.NRLRQCount,
				  TotalQCount = LC.TotalQCount,
				  TotalNRQCount = LC.TotalNRQCount
			  FROM [EDDSPerformance].[eddsdbo].[PerformanceSummary] AS PS  
				INNER JOIN [EDDSPerformance].[eddsdbo].LRQCountDW AS LC
				ON PS.CaseArtifactID = LC.CaseArtifactID 
				AND DATEPART(HH,PS.MeasureDate) =  LC.MeasureHour 
				AND CAST(PS.MeasureDate AS DATE) = LC.MeasureDate
				AND PS.CaseArtifactID = LC.CaseArtifactID
	END
	ELSE
	BEGIN
		BEGIN TRAN
			  UPDATE PS
			  SET LRQCount = LC.LRQCount,
				  NRLRQCount = LC.NRLRQCount,
				  TotalQCount = LC.TotalQCount,
				  TotalNRQCount = LC.TotalNRQCount
			  FROM [EDDSPerformance].[eddsdbo].[PerformanceSummary] AS PS  
				INNER JOIN [EDDSPerformance].[eddsdbo].LRQCountDW AS LC
				ON PS.CaseArtifactID = LC.CaseArtifactID 
				AND DATEPART(HH,PS.MeasureDate) =  LC.MeasureHour 
				AND CAST(PS.MeasureDate AS DATE) = LC.MeasureDate
				AND PS.CaseArtifactID = LC.CaseArtifactID
		
		
 			Insert PerformanceSummary
			Select 
			GetUTCDate() CreatedOn, 
			C.ArtifactID CaseArtifactID, 	
			@SummaryMeasureDate MeasureDate, 
			COALESCE(UC.UserCount,0) UserCount,
			COALESCE(EC.ErrorCount,0) ErrorCount,
			COALESCE(LC.TQCount,0) TotalQCount, 
			COALESCE(LC.LRQCount,0) LRQCount,
			COALESCE(LC.NRLRQCount,0) NRLRQCount, 
			COALESCE(LC.TotalNRQCount, 0) TotalNRQCount,
			COALESCE(AL.AverageLatency,0) AverageLatency
			From  EDDS.eddsdbo.[Case] C
			Left Join 
			(Select CaseArtifactID, AVG(UserCount) UserCount   
			From eddsdbo.UserCountDW 
			Where MeasureDate = @MeasureDate AND MeasureHour = @MeasureHour Group By CaseArtifactID) UC
			On C.ArtifactID = UC.CaseArtifactID
			Left Join (Select CaseArtifactID, SUM(ErrorCount) ErrorCount    
			From eddsdbo.ErrorCountDW 
			Where MeasureDate = @MeasureDate AND MeasureHour = @MeasureHour  Group By CaseArtifactID) EC
			On C.ArtifactID = EC.CaseArtifactID
			Left Join (Select CaseArtifactID, SUM(TotalQCount) TQCount, SUM(LRQCount) LRQCount, SUM(NRLRQCount) NRLRQCount, SUM(TotalNRQCount) TotalNRQCount   
			From eddsdbo.LRQCountDW 
			Where MeasureDate = @MeasureDate AND MeasureHour = @MeasureHour  Group By CaseArtifactID) LC
			On C.ArtifactID = LC.CaseArtifactID
			Left Join (Select CaseArtifactID, AVG(AverageLatency) AverageLatency
			From eddsdbo.LatencyDW 
			Where MeasureDate = @MeasureDate AND MeasureHour = @MeasureHour  Group By CaseArtifactID) AL
			On C.ArtifactID = AL.CaseArtifactID
		COMMIT TRAN
	END
END
GO

PRINT N'Create procedure [eddsdbo].[GetApplicationHealthData]'
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[eddsdbo].[GetApplicationHealthData]') AND type in (N'P', N'PC'))
DROP PROCEDURE [eddsdbo].[GetApplicationHealthData]
GO
DECLARE @_1 AS VARBINARY(MAX)
DECLARE @_2 AS VARBINARY(MAX)
SET @_1 = 0x0D000A004300520045004100540045002000500052004F0043004500440055005200450020005B006500640064007300640062006F005D002E005B004700650074004100700070006C00690063006100740069006F006E004800650061006C007400680044006100740061005D000D000A0028000D000A000900400053007400610072007400440061007400650009004400410054004500540049004D00450020003D0020004E0055004C004C002C000D000A000900400045006E006400440061007400650009004400410054004500540049004D00450020003D0020004E0055004C004C002C000D000A0009004000540069006D0065005A006F006E0065004F0066006600730065007400200069006E0074000D000A0029000D000A005700490054004800200045004E004300520059005000540049004F004E000D000A00410053000D000A0042004500470049004E000D000A0009002D002D00200053004500540020004E004F0043004F0055004E00540020004F004E00200061006400640065006400200074006F002000700072006500760065006E007400200065007800740072006100200072006500730075006C007400200073006500740073002000660072006F006D000D000A0009002D002D00200069006E0074006500720066006500720069006E006700200077006900740068002000530045004C004500430054002000730074006100740065006D0065006E00740073002E000D000A00090053004500540020004E004F0043004F0055004E00540020004F004E003B000D000A0009000D000A0009004400450043004C004100520045002000400070007700640020004E005600610072006300680061007200280031003000300029000D000A0009005300450054002000400070007700640020003D00200027006B004300750072006100500061007300730077006F00720064003100210027000D000A0009000D000A0009004900460020002800400053007400610072007400440061007400650020004900530020004E0055004C004C00200041004E0044002000400045006E006400440061007400650020004900530020004E0055004C004C0029000D000A000900090042004500470049004E000D000A000900090009002D002D00530045004C004500430054002000400053007400610072007400440061007400650020003D00200044004100540045004100440044002800480048002C0020002D002000320033002C00200047004500540055005400430044004100540045002800290029000D000A00090009000900530045004C004500430054002000400053007400610072007400440061007400650020003D00200044004100540045004100440044002800480048002C002D00320033002C004400410054004500410044004400280048004F00550052002C002000440041005400450044004900460046002800480048002C00200030002C002000440041005400450041004400440028004D0049004E005500540045002C0020004000540069006D0065005A006F006E0065004F00660066007300650074002C0020004700450054005500540043004400410054004500280029002900290020002C0030002900290009000900090009000D000A000900090009005300450054002000400045006E006400440061007400650020003D00200040005300740061007200740044006100740065000900090009000D000A000900090045004E0044000D000A0009000D000A0009002D002D00200049006E0073006500720074002000730074006100740065006D0065006E0074007300200066006F0072002000700072006F00630065006400750072006500200068006500720065000D000A00090020004900460020002800400053007400610072007400440061007400650020003D002000400045006E00640044006100740065002900090009000D000A0009000900200042004500470049004E000900090020000D000A00090009000900530045004C004500430054000D000A00090009000900090052004F0057005F004E0055004D004200450052002800290020004F0056004500520028004F0052004400450052002000420059002000570053002E00430061007300650041007200740069006600610063007400490044002C0020004400610074006500520061006E0067006500290020004100530020004900640009000900090009000D000A0009000900090009002C002000490053004E0055004C004C002800570053002E00430061007300650041007200740069006600610063007400490044002C00300029002000610073002000430061007300650041007200740069006600610063007400490044000D000A0009000900090009002C002000490053004E0055004C004C002800570053002E0057006F0072006B00730070006100630065004E0061006D0065002C00270027002900200061007300200057006F0072006B00730070006100630065004E0061006D00650009000900090009000D000A0009000900090009002C002000490053004E0055004C004C002800570053002E005B00440061007400610062006100730065004C006F0063006100740069006F006E005D002C0027002700290020006100730020005B00440061007400610062006100730065004C006F0063006100740069006F006E005D000D000A0009000900090009002C002000640072002E004400610074006500520061006E006700650020006100730020004D0065006100730075007200650044006100740065000D000A0009000900090009002C002000490053004E0055004C004C002800500053002E00550073006500720043006F0075006E0074002C0020002D00310029002000410053002000550073006500720043006F0075006E0074000D000A0009000900090009002C002000490053004E0055004C004C002800500053002E004500720072006F00720043006F0075006E0074002C0020002D003100290020004100530020004500720072006F00720043006F0075006E0074000D000A0009000900090009002C002000490053004E0055004C004C002800500053002E004C005200510043006F0075006E0074002C0020002D003100290020004100530020004C005200510043006F0075006E0074000D000A0009000900090009002C002000490053004E0055004C004C002800500053002E0041007600650072006100670065004C006100740065006E00630079002C002D0031002900200041005300200041007600650072006100670065004C006100740065006E00630079000D000A0009000900090009002C00430041005300450020000D000A0009000900090009005700480045004E0020004200490053002E0054006F00740061006C00510043006F0075006E00740020003E0020003000200041004E004400200028004200490053002E004E0052004C005200510043006F0075006E0074002F00430041005300540028004200490053002E0054006F00740061006C00510043006F0075006E007400200041005300200066006C006F006100740029002A00310030003000290020003C0020003100300020005400480045004E002000310020002D002D005000610073007300650064000D000A0009000900090009005700480045004E0020004200490053002E0054006F00740061006C00510043006F0075006E00740020003E0020003000200041004E004400200028004200490053002E004E0052004C005200510043006F0075006E0074002F00430041005300540028004200490053002E0054006F00740061006C00510043006F0075006E007400200041005300200066006C006F006100740029002A00310030003000290020003E003D00200031003000200041004E004400200028004200490053002E004E0052004C005200510043006F0075006E0074002F00430041005300540028004200490053002E0054006F00740061006C00510043006F0075006E007400200041005300200066006C006F006100740029002A00310030003000290020003C0020003100350020005400480045004E002000320020002D002D00500072006F0062006100740069006F006E000D000A0009000900090009005700480045004E0020004200490053002E0054006F00740061006C00510043006F0075006E00740020003E0020003000200041004E004400200028004200490053002E004E0052004C005200510043006F0075006E0074002F00430041005300540028004200490053002E0054006F00740061006C00510043006F0075006E007400200041005300200066006C006F006100740029002A00310030003000290020003E003D0020003100350020005400480045004E0020003300200020002D002D004600610069006C000D000A00090009000900090045004C0053004500200031000D000A00090009000900090045004E004400200041005300200042004900530049006E00640069006300610074006F0072000D000A0009000900090009002C00490053004E0055004C004C0028004200490053002E0054006F00740061006C00510043006F0075006E0074002C003000290020004100530020005400510043006F0075006E0074000D000A00090009000900460052004F004D0020005B006500640064007300640062006F005D002E004700650074004400610074006500520061006E0067006500280040005300740061007200740044006100740065002C002000400045006E006400440061007400650029002000640072000D000A000900090009000900430052004F005300530020004A004F0049004E0020000D000A00090009000900090028000D000A0009000900090009000900530045004C004500430054002000440049005300540049004E004300540020000D000A0009000900090009000900090077002E00430061007300650041007200740069006600610063007400490044000D000A000900090009000900090009002C00200077002E0057006F0072006B00730070006100630065004E0061006D0065000D000A000900090009000900090009002C00200077002E005B00440061007400610062006100730065004C006F0063006100740069006F006E005D000D000A0009000900090009000900460052004F004D0020006500640064007300640062006F002E00450044004400530057006F0072006B00730070006100630065002000770009000900090009000D000A000900090009000900090009004A004F0049004E0020006500640064007300640062006F002E0050006500720066006F0072006D0061006E0063006500530075006D006D0061007200790020005000430020006F006E002000500043002E004300610073006500410072007400690066006100630074004900440020003D00200077002E0043006100730065004100720074006900660061006300740049004400200009000900090009000D000A00090009000900090009000900090041004E0044002000440041005400450041004400440028004D0049002C0020004000540069006D0065005A006F006E0065004F00660066007300650074002C0020004D006500610073007500720065004400610074006500290020003E003D002000400053007400610072007400440061007400650020000D000A00090009000900090009000900090041004E0044002000440041005400450041004400440028004D0049002C0020004000540069006D0065005A006F006E0065004F00660066007300650074002C0020004D006500610073007500720065004400610074006500290020003C002000400045006E006400440061007400650020002B00200031000D000A00090009000900090029002000610073002000570053000D000A0009000900090009004C0045004600540020004A004F0049004E0020006500640064007300640062006F002E0050006500720066006F0072006D0061006E0063006500530075006D006D006100720079002000500053000D000A00090009000900090009004F004E002000440041005400450041004400440028004D0049002C0020004000540069006D0065005A006F006E0065004F00660066007300650074002C0020004400410054004500410044004400280048004F00550052002C00200044004100540045005000410052005400280048004F00550052002C004D00650061007300750072006500440061007400650029002C00200043004F004E0056004500520054002800760061007200630068006100720028003100300029002C0020004D00650061007300750072006500440061007400650020002C0031003000310029002900290020003D0020004400410054004500410044004400280048004F00550052002C00200044004100540045005000410052005400280048004F00550052002C00640072002E004400610074006500520061006E006700650029002C00200043004F004E0056004500520054002800760061007200630068006100720028003100300029002C002000640072002E004400610074006500520061006E00670065002C003100300031002900290009000900090009002000200020002000090009000900200020000D000A0009000900090009000900090041004E0044002000570053002E004300610073006500410072007400690066006100630074004900440020003D002000500053002E00430061007300650041007200740069006600610063007400490044000900090009000900200020000D000A0009000900090009004C0045004600540020004A004F0049004E00200028000D000A0009000900090009000900530045004C004500430054000D000A000900090009000900090009004C00440057002E00430061007300650041007200740069006600610063007400490044002000410053002000430061007300650041007200740069006600610063007400490044002C000D000A00090009000900090009000900530055004D0028004C00440057002E004E0052004C005200510043006F0075006E007400290020004100530020004E0052004C005200510043006F0075006E0074002C000D000A00090009000900090009000900530055004D0028004C00440057002E0054006F00740061006C00510043006F0075006E0074002900200041005300200054006F00740061006C00510043006F0075006E0074000D000A0009000900090009000900460052004F004D000D000A000900090009000900090009006500640064007300640062006F002E004C005200510043006F0075006E0074004400570020004C00440057000D000A0009000900090009000900570048004500520045000D000A00090009000900090009000900440041005400450041004400440028004D0049002C0020004000540069006D0065005A006F006E0065004F00660066007300650074002C0020004400410054004500410044004400280048004F00550052002C004C00440057002E004D0065006100730075007200650048006F00750072002C002000630061007300740028004C00440057002E004D00650061007300750072006500440061007400650020006100730020006400610074006500740069006D00650029002900290020004200450054005700450045004E000D000A000900090009000900090009004000530074006100720074004400610074006500200041004E0044002000400045006E006400440061007400650020002B00200031000D000A0009000900090009000900470052004F00550050002000420059000D000A000900090009000900090009004C00440057002E00430061007300650041007200740069006600610063007400490044000D000A0009000900090009002900200042004900530020000D000A00090009000900090009004F004E002000570053002E004300610073006500410072007400690066006100630074004900440020003D0020004200490053002E004300610073006500410072007400690066006100630074004900440020000900090009000900090009000D000A000900090045004E0044000D000A00090045004C00
SET @_2 = 0x530045000900090042004500470049004E0009000D000A00090009000900530045004C004500430054000D000A00090009000900090052004F0057005F004E0055004D004200450052002800290020004F0056004500520028004F0052004400450052002000420059002000570053002E00430061007300650041007200740069006600610063007400490044002C0020004400610074006500520061006E00670065002900200041005300200049006400090009000900090009000900090009000D000A0009000900090009002C002000570053002E00430061007300650041007200740069006600610063007400490044002000610073002000430061007300650041007200740069006600610063007400490044000D000A0009000900090009002C002000570053002E0057006F0072006B00730070006100630065004E0061006D006500200061007300200057006F0072006B00730070006100630065004E0061006D0065000900090009000900090009000D000A0009000900090009002C002000490053004E0055004C004C002800570053002E005B00440061007400610062006100730065004C006F0063006100740069006F006E005D002C0027002700290020006100730020005B00440061007400610062006100730065004C006F0063006100740069006F006E005D000D000A0009000900090009002C002000640072002E004400610074006500520061006E006700650020006100730020004D0065006100730075007200650044006100740065000D000A0009000900090009002C002000490053004E0055004C004C002800500053002E00550073006500720043006F0075006E0074002C0020002D00310029002000410053002000550073006500720043006F0075006E0074000D000A0009000900090009002C002000490053004E0055004C004C002800500053002E004500720072006F00720043006F0075006E0074002C0020002D003100290020004100530020004500720072006F00720043006F0075006E0074000D000A0009000900090009002C002000490053004E0055004C004C002800500053002E004C005200510043006F0075006E0074002C0020002D003100290020004100530020004C005200510043006F0075006E0074000D000A0009000900090009002C002000490053004E0055004C004C002800500053002E0041007600650072006100670065004C006100740065006E00630079002C002D0031002900200041005300200041007600650072006100670065004C006100740065006E00630079000D000A0009000900090009002C002000490053004E0055004C004C0028000D000A000900090009000900090043006F006E007600650072007400280069006E0074002C0020000D000A0009000900090009000900090043006F006E00760065007200740028006E00760061007200630068006100720028006D006100780029002C00090009000900090009000D000A0009000900090009000900090009004400650063007200790070007400420079005000610073007300500068007200610073006500280040007000770064002C0020000D000A000900090009000900090009000900090043004F004E00560045005200540028006E00760061007200630068006100720028006D006100780029002C004200490053002E0053007400610074007500730044006100790029002C0020000D000A000900090009000900090009000900090031002C0020000D000A000900090009000900090009000900090043004F004E00560045005200540028002000760061007200620069006E006100720079002C0020004200490053002E004D00650061007300750072006500440061007400650029000D000A00090009000900090009000900090029000D000A0009000900090009000900090029000D000A0009000900090009000900290009000900090009000D000A0009000900090009002C0030002900200041005300200042004900530049006E00640069006300610074006F0072000D000A0009000900090009002C002000490053004E0055004C004C0028004200490053002E005400510043006F0075006E0074002C003000290020004100530020005400510043006F0075006E0074000D000A00090009000900460052004F004D0020005B006500640064007300640062006F005D002E004700650074004400610074006500520061006E0067006500280040005300740061007200740044006100740065002C002000400045006E006400440061007400650029002000640072000D000A000900090009000900430052004F005300530020004A004F0049004E0020000D000A00090009000900090028000D000A0009000900090009000900530045004C004500430054002000440049005300540049004E004300540020000D000A0009000900090009000900090077002E00430061007300650041007200740069006600610063007400490044000D000A000900090009000900090009002C00200077002E0057006F0072006B00730070006100630065004E0061006D0065000D000A000900090009000900090009002C00200077002E005B00440061007400610062006100730065004C006F0063006100740069006F006E005D000D000A0009000900090009000900460052004F004D0020006500640064007300640062006F002E00450044004400530057006F0072006B00730070006100630065002000770009000900090009000D000A000900090009000900090009004A004F0049004E0020006500640064007300640062006F002E0050006500720066006F0072006D0061006E0063006500530075006D006D0061007200790020005000530020006F006E002000500053002E004300610073006500410072007400690066006100630074004900440020003D00200077002E004300610073006500410072007400690066006100630074004900440020000D000A00090009000900090009000900090041004E0044002000440041005400450041004400440028004D0049002C0020004000540069006D0065005A006F006E0065004F00660066007300650074002C0020004D006500610073007500720065004400610074006500290020003E003D002000400053007400610072007400440061007400650020000D000A00090009000900090009000900090041004E0044002000440041005400450041004400440028004D0049002C0020004000540069006D0065005A006F006E0065004F00660066007300650074002C0020004D006500610073007500720065004400610074006500290020003C0020002800400045006E006400440061007400650020002B002000310029000D000A00090009000900090029002000610073002000570053000D000A0009000900090009004C0045004600540020004A004F0049004E0020000D000A00090009000900090028000D000A0009000900090009000900530045004C0045004300540020000D000A00090009000900090009000900500053002E00430061007300650041007200740069006600610063007400490044000D000A000900090009000900090009002C00200044004100540045004100440044002800440044002C00200030002C002000440041005400450044004900460046002800440044002C00200030002C002000440041005400450041004400440028004D0049002C0020004000540069006D0065005A006F006E0065004F00660066007300650074002C0020004D00650061007300750072006500440061007400650029002900290020005B004D0065006100730075007200650044006100740065005D000D000A000900090009000900090009002C0020004100560047002800500053002E00550073006500720043006F0075006E00740029002000410053002000550073006500720043006F0075006E0074000D000A000900090009000900090009002C002000530055004D002800500053002E004500720072006F00720043006F0075006E007400290020004100530020004500720072006F00720043006F0075006E0074000D000A000900090009000900090009002C002000530055004D002800500053002E004C005200510043006F0075006E007400290020004100530020004C005200510043006F0075006E0074000D000A000900090009000900090009002C0020004100560047002800500053002E0041007600650072006100670065004C006100740065006E006300790029002000200041005300200041007600650072006100670065004C006100740065006E00630079000D000A0009000900090009000900460052004F004D0020006500640064007300640062006F002E0050006500720066006F0072006D0061006E0063006500530075006D006D006100720079002000500053000D000A0009000900090009000900570048004500520045002000440041005400450041004400440028004D0049002C0020004000540069006D0065005A006F006E0065004F00660066007300650074002C004D006500610073007500720065004400610074006500290020003E003D0020002000400053007400610072007400440061007400650020000D000A0009000900090009000900090041004E0044002000440041005400450041004400440028004D0049002C0020004000540069006D0065005A006F006E0065004F00660066007300650074002C004D006500610073007500720065004400610074006500290020003C0020002800400045006E006400440061007400650020002B002000310029000D000A0009000900090009000900470052004F00550050002000420059002000500053002E00430061007300650041007200740069006600610063007400490044000D000A000900090009000900090009002C00200044004100540045004100440044002800440044002C00200030002C002000440041005400450044004900460046002800440044002C00200030002C002000440041005400450041004400440028004D0049002C0020004000540069006D0065005A006F006E0065004F00660066007300650074002C0020004D0065006100730075007200650044006100740065002900290029000D000A000900090009000900290020006100730020005000530020006F006E002000500053002E004D00650061007300750072006500440061007400650020003D002000640072002E004400610074006500520061006E006700650020000D000A000900090009000900090041004E0044002000570053002E004300610073006500410072007400690066006100630074004900440020003D002000500053002E00430061007300650041007200740069006600610063007400490044000D000A0009000900090009004C0045004600540020004A004F0049004E0009000D000A0009000900090009006500640064007300640062006F002E00420049005300530075006D006D00610072007900200042004900530020004F004E0020004200490053002E004D00650061007300750072006500440061007400650020003D00200044004100540045004100440044002800440044002C00200030002C002000640072002E004400610074006500520061006E00670065002900200041004E0044002000570053002E004300610073006500410072007400690066006100630074004900440020003D0020004200490053002E004300610073006500410072007400690066006100630074004900440020000D000A000900090045004E00440009000D000A0045004E0044000D000A000D000A00
EXEC (@_1 + @_2)
GO

PRINT N'Adding stored procedure [eddsdbo].[GetBISHealthData]'
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[eddsdbo].[GetBISHealthData]') AND type in (N'P', N'PC'))
DROP PROCEDURE [eddsdbo].[GetBISHealthData]
GO
DECLARE @_ AS VARBINARY(MAX)
SET @_ = 0x0D000A004300520045004100540045002000500052004F0043004500440055005200450020005B006500640064007300640062006F005D002E005B004700650074004200490053004800650061006C007400680044006100740061005D000D000A0028000D000A000900400057006F0072006B007300700061006300650049006400200069006E0074002C000D000A000900400053007400610072007400440061007400650009004400410054004500540049004D00450020003D0020004E0055004C004C002C000D000A000900400045006E006400440061007400650009004400410054004500540049004D00450020003D0020004E0055004C004C002C000D000A0009004000540069006D0065005A006F006E0065004F0066006600730065007400200069006E0074000D000A0029000D000A005700490054004800200045004E004300520059005000540049004F004E00200020000D000A00410053000D000A0042004500470049004E000D000A00090053004500540020004E004F0043004F0055004E00540020004F004E003B000D000A0009004400450043004C004100520045002000400070007700640020004E005600610072006300680061007200280031003000300029000D000A0009005300450054002000400070007700640020003D00200027006B004300750072006100500061007300730077006F00720064003100210027000D000A0009004900460020002800400053007400610072007400440061007400650020004900530020004E0055004C004C00200041004E0044002000400045006E006400440061007400650020004900530020004E0055004C004C0029000D000A000900090042004500470049004E000D000A00090009000900530045004C004500430054002000400053007400610072007400440061007400650020003D00200044004100540045004100440044002800480048002C002D00320033002C004400410054004500410044004400280048004F00550052002C002000440041005400450044004900460046002800480048002C00200030002C002000440041005400450041004400440028004D0049004E005500540045002C0020004000540069006D0065005A006F006E0065004F00660066007300650074002C0020004700450054005500540043004400410054004500280029002900290020002C0030002900290009000900090009000D000A000900090009005300450054002000400045006E006400440061007400650020003D00200040005300740061007200740044006100740065000900090009000D000A000900090045004E0044000D000A0009000D000A000900530045004C004500430054000D000A000900090052004F0057005F004E0055004D004200450052002800290020004F0056004500520028004F0052004400450052002000420059002000570053002E00430061007300650041007200740069006600610063007400490044002C002000440052002E004400610074006500520061006E00670065002900200041005300200049006400090009000900090009000900090009000D000A00090009002C002000570053002E00430061007300650041007200740069006600610063007400490044002000610073002000430061007300650041007200740069006600610063007400490044000D000A00090009002C002000570053002E0057006F0072006B00730070006100630065004E0061006D006500200061007300200057006F0072006B00730070006100630065004E0061006D0065000900090009000900090009000D000A00090009002C002000440052002E004400610074006500520061006E006700650020006100730020004D0065006100730075007200650044006100740065000D000A00090009002C002000490053004E0055004C004C002800500053002E0042004900530049006E00640069006300610074006F0072002C0030002900200041005300200042004900530049006E00640069006300610074006F0072000D000A000900460052004F004D0020000D000A00090009005B006500640064007300640062006F005D002E004700650074004400610074006500520061006E0067006500280040005300740061007200740044006100740065002C002000400045006E0064004400610074006500290020004400520020000D000A0009000900430052004F005300530020004A004F0049004E0020000D000A000900090028000D000A00090009000900530045004C004500430054002000440049005300540049004E004300540020000D000A00090009000900090077002E00430061007300650041007200740069006600610063007400490044000D000A0009000900090009002C0077002E0057006F0072006B00730070006100630065004E0061006D0065000D000A00090009000900460052004F004D0020000D000A0009000900090009006500640064007300640062006F002E00450044004400530057006F0072006B00730070006100630065002000770020000D000A00090009000900570048004500520045000D000A00090009000900090077002E004300610073006500410072007400690066006100630074004900440020003D002000400057006F0072006B0073007000610063006500490064000D000A00090009002900200041005300200057005300090009000D000A00090009004C0045004600540020004A004F0049004E0020000D000A000900090028000D000A00090009000900530045004C0045004300540020000D000A000900090009000900420053002E00430061007300650041007200740069006600610063007400490044000D000A0009000900090009002C0020004D00650061007300750072006500440061007400650020004100530020005B004D0065006100730075007200650044006100740065005D000D000A0009000900090009002C00200043006F006E007600650072007400280069006E0074002C000D000A00090009000900090009002000200043006F006E00760065007200740028006E00760061007200630068006100720028006D006100780029002C0020000D000A000900090009000900090009004400650063007200790070007400420079005000610073007300500068007200610073006500280040007000770064002C0020000D000A00090009000900090009000900090043004F004E00560045005200540028006E00760061007200630068006100720028006D006100780029002C00420053002E0053007400610074007500730044006100790029002C0020000D000A00090009000900090009000900090031002C0020000D000A00090009000900090009000900090043004F004E00560045005200540028002000760061007200620069006E006100720079002C0020004D00650061007300750072006500440061007400650029000D000A0009000900090009000900090029000D000A000900090009000900090029000D000A00090009000900090020002000290020004100530020005B0042004900530049006E00640069006300610074006F0072005D000D000A00090009000900460052004F004D0020000D000A0009000900090009006500640064007300640062006F002E00420049005300530075006D006D006100720079002000420053000D000A000900090009005700480045005200450020000D000A0009000900090009004D00650061007300750072006500440061007400650020003E003D0020002000400053007400610072007400440061007400650020000D000A00090009000900090041004E00440020004D00650061007300750072006500440061007400650020003C0020002800400045006E006400440061007400650020002B002000310029000D000A00090009000900090041004E0044002000420053002E004300610073006500410072007400690066006100630074004900440020003D002000400057006F0072006B0073007000610063006500490064000D000A0009000900290020004100530020005000530020006F006E002000500053002E004D00650061007300750072006500440061007400650020003D002000640072002E004400610074006500520061006E006700650020000D000A000900090041004E0044002000570053002E004300610073006500410072007400690066006100630074004900440020003D002000500053002E00430061007300650041007200740069006600610063007400490044000D000A0045004E0044000D000A000D000A000D000A00
EXEC (@_)
GO

PRINT N'Create procedure [eddsdbo].[LoadBISSummary]'
GO
/****** 2013-02-19 : Ron@Milyli - Updated to new version. See eddsdbo.LoadBISSummary.StoredProcedure.ToEncrypt for how this is done ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[eddsdbo].[LoadBISSummary]') AND type in (N'P', N'PC'))
DROP PROCEDURE [eddsdbo].[LoadBISSummary]
GO
DECLARE @_ AS VARBINARY(MAX)
SET @_ = 0x0D000A002D002D0020003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D000D000A002D002D00200041007500740068006F0072003A000900090052006F006E0040004D0069006C0079006C0069000D000A002D002D002000430072006500610074006500200064006100740065003A00200032003000310032002D00300036002D00300031000D000A002D002D0020004400650073006300720069007000740069006F006E003A0009000D000A002D002D00200032003000310033002D00300032002D003100380020003A00200052006F006E0040004D0069006C0079006C00690020003A0020004100640064006500640020006E0065007700200054006F00740061006C004E005200510043006F0075006E00740020006600690065006C0064000D000A002D002D00200032003000310033002D00300032002D003100380020003A00200052006F006E0040004D0069006C0079006C00690020003A00200041006400640065006400200074006800650020006600690065006C006400200065006E006300720079007000740069006F006E00200063006F00640065000D000A002D002D0020003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D000D000A004300520045004100540045002000500052004F0043004500440055005200450020005B006500640064007300640062006F005D002E005B004C006F0061006400420049005300530075006D006D006100720079005D000D000A0009004000500072006F0063006500730073004500780065006300440061007400650020004400610074006500540069006D00650020000D000A005700490054004800200045004E004300520059005000540049004F004E000D000A00410053000D000A0042004500470049004E000D000A00090053004500540020004E004F0043004F0055004E00540020004F004E003B000D000A000D000A0009004400450043004C004100520045002000400070007700640020004E005600610072006300680061007200280031003000300029000D000A0009005300450054002000400070007700640020003D00200027006B004300750072006100500061007300730077006F00720064003100210027000D000A000D000A0009004400650063006C0061007200650020004000530075006D006D006100720079004D00650061007300750072006500440061007400650020004400610074006500540069006D0065000D000A0009004400650063006C00610072006500200040004D006500610073007500720065004400610074006500200044006100740065000D000A0009000D000A000900530065006C00650063007400200040004D00650061007300750072006500440061007400650020003D002000430061007300740028004000500072006F006300650073007300450078006500630044006100740065002000610073002000440061007400650029000D000A000900530065006C0065006300740020004000530075006D006D006100720079004D00650061007300750072006500440061007400650020003D00200040004D0065006100730075007200650044006100740065000D000A000D000A0009004900460020004500580049005300540053002800530065006C00650063007400200031002000460072006F006D0020006500640064007300640062006F002E00420049005300530075006D006D0061007200790020005700680065007200650020004D00650061007300750072006500440061007400650020003D0020004000530075006D006D006100720079004D00650061007300750072006500440061007400650029000D000A00090042004500470049004E0020000D000A000900200020002D002D004500780069007300740069006E00670020006400610074006100200066006F0072002000740068006500200064006100740065002C002000720075006E00200061006E0020007500700064006100740065000D000A0009002000200042004500470049004E0020005400520041004E000D000A000900090055005000440041005400450020006500640064007300640062006F002E00420049005300530075006D006D006100720079000D000A000900090053004500540020005400510043006F0075006E00740020003D00200043004F0041004C00450053004300450028004C0043002E005400510043006F0075006E0074002C00300029002C000D000A0009000900090054006F00740061006C004E005200510043006F0075006E00740020003D00200043004F0041004C00450053004300450028004C0043002E0054006F00740061006C004E005200510043006F0075006E0074002C002000300029002C000D000A000900090009004E0052004C005200510043006F0075006E00740020003D00200043004F0041004C00450053004300450028004C0043002E004E0052004C005200510043006F0075006E0074002C00300029000D000A0009000900460052004F004D000D000A000900090009006500640064007300640062006F002E00420049005300530075006D006D006100720079002000420053000D000A000900090009004C0065006600740020004A006F0069006E0020002800530065006C006500630074002000430061007300650041007200740069006600610063007400490044002C002000530055004D00280054006F00740061006C00510043006F0075006E007400290020005400510043006F0075006E0074002C002000530055004D00280054006F00740061006C004E005200510043006F0075006E0074002900200054006F00740061006C004E005200510043006F0075006E0074002C002000530055004D0028004C005200510043006F0075006E007400290020004C005200510043006F0075006E0074002C002000530055004D0028004E0052004C005200510043006F0075006E007400290020004E0052004C005200510043006F0075006E0074002000200020000D000A00090009000900460072006F006D0020006500640064007300640062006F002E004C005200510043006F0075006E0074004400570020007700680065007200650020004D00650061007300750072006500440061007400650020003D00200040004D0065006100730075007200650044006100740065002000470072006F0075007000200042007900200043006100730065004100720074006900660061006300740049004400290020004C0043000D000A000900090009004F006E002000420053002E004300610073006500410072007400690066006100630074004900440020003D0020004C0043002E004300610073006500410072007400690066006100630074004900440020000D000A0009000900090041004E0044002000420053002E004D00650061007300750072006500440061007400650020003D00200040004D0065006100730075007200650044006100740065000900090009000D000A0009002000200043004F004D004D004900540020005400520041004E0020000D000A000D000A00090045004E0044000D000A000D000A00090045004C00530045000D000A000D000A00090042004500470049004E000D000A00090020002000200020002D002D004E006500770020006400610079002C00200073006F00200064006F00200061006E00200069006E0069007400690061006C00200069006E0073006500720074000D000A000900090042004500470049004E0020005400520041004E000D000A00200009000900090049004E00530045005200540020006500640064007300640062006F002E00420049005300530075006D006D006100720079002000280043007200650061007400650064004F006E002C002000430061007300650041007200740069006600610063007400490044002C0020004D0065006100730075007200650044006100740065002C0020005400510043006F0075006E0074002C00200054006F00740061006C004E005200510043006F0075006E0074002C0020004E0052004C005200510043006F0075006E0074002C0020005300740061007400750073004400610079002C0020005300740061007400750073003900300044006100790073002C002000530074006100740075007300500065007200630065006E0074006100670065004E0052004C00520051004400610079002C002000530074006100740075007300500065007200630065006E0074006100670065004E0052004C005200510039003000440061007900730029000D000A00090009000900530045004C0045004300540020000D000A000900090009000900470065007400550054004300440061007400650028002900200043007200650061007400650064004F006E002C0020000D000A00090009000900090043002E0041007200740069006600610063007400490044002000430061007300650041007200740069006600610063007400490044002C00200009000D000A0009000900090009004000530075006D006D006100720079004D00650061007300750072006500440061007400650020004D0065006100730075007200650044006100740065002C0020000D000A00090009000900090043004F0041004C00450053004300450028004C0043002E005400510043006F0075006E0074002C003000290020005400510043006F0075006E0074002C0020000D000A00090009000900200020002000200043004F0041004C00450053004300450028004C0043002E0054006F00740061006C004E005200510043006F0075006E0074002C00200030002900200054006F00740061006C004E005200510043006F0075006E0074002C000D000A00090009000900090043004F0041004C00450053004300450028004C0043002E004E0052004C005200510043006F0075006E0074002C003000290020004E0052004C005200510043006F0075006E0074002C0020000D000A00090009000900090045006E0063007200790070007400420079005000610073007300500068007200610073006500280040007000770064002C004E0027002D00310027002C0031002C0043004F004E00560045005200540028002000760061007200620069006E006100720079002C0020004000530075006D006D006100720079004D0065006100730075007200650044006100740065002900290020005300740061007400750073004400610079002C000D000A00090009000900090045006E0063007200790070007400420079005000610073007300500068007200610073006500280040007000770064002C004E0027002D00310027002C0031002C0043004F004E00560045005200540028002000760061007200620069006E006100720079002C0020004000530075006D006D006100720079004D0065006100730075007200650044006100740065002900290020005300740061007400750073003900300044006100790073002C000D000A0009000900090009002D00310020002000530074006100740075007300500065007200630065006E0074006100670065004E0052004C00520051004400610079002C000D000A0009000900090009002D0031002000530074006100740075007300500065007200630065006E0074006100670065004E0052004C00520051003900300044006100790073000D000A00090009000900460072006F006D000D000A000900090009002000200045004400440053002E006500640064007300640062006F002E005B0043006100730065005D00200043000D000A000900090009004C0065006600740020004A006F0069006E0020002800530065006C006500630074002000430061007300650041007200740069006600610063007400490044002C002000530055004D00280054006F00740061006C00510043006F0075006E007400290020005400510043006F0075006E0074002C002000530055004D00280054006F00740061006C004E005200510043006F0075006E0074002900200054006F00740061006C004E005200510043006F0075006E0074002C002000530055004D0028004C005200510043006F0075006E007400290020004C005200510043006F0075006E0074002C002000530055004D0028004E0052004C005200510043006F0075006E007400290020004E0052004C005200510043006F0075006E0074002000200020000D000A00090009000900460072006F006D0020006500640064007300640062006F002E004C005200510043006F0075006E0074004400570020000D000A000900090009005700680065007200650020004D00650061007300750072006500440061007400650020003D00200040004D0065006100730075007200650044006100740065002000470072006F0075007000200042007900200043006100730065004100720074006900660061006300740049004400290020004C0043000D000A000900090009004F006E00200043002E00410072007400690066006100630074004900440020003D0020004C0043002E00430061007300650041007200740069006600610063007400490044000D000A000D000A000900090043004F004D004D004900540020005400520041004E000D000A00090045004E0044000D000A000D000A0045004E0044000D000A00
EXEC (@_)
GO

PRINT N'Create procedure [eddsdbo].[UpdateBISScores]'
GO
/****** 2013-02-19 : Ron@Milyli - Updated to new version. See eddsdbo.UpdateBISScores.StoredProcedure.ToEncrypt for how this is done ******/

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[eddsdbo].UpdateBISScores') AND type in (N'P', N'PC'))
DROP PROCEDURE [eddsdbo].[UpdateBISScores]
GO
DECLARE @_ AS VARBINARY(MAX)
SET @_ = 0x0D000A002D002D0020003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D000D000A002D002D00200041007500740068006F0072003A000900090052006F006E0040004D0069006C0079006C0069000D000A002D002D002000430072006500610074006500200064006100740065003A00200032003000310032002D00300036002D00300031000D000A002D002D0020004400650073006300720069007000740069006F006E003A00090050006F00700075006C0061007400650020004200490053002000560061006C007500650073000D000A002D002D00200032003000310033002D00300032002D003100380020003A00200052006F006E0040004D0069006C0079006C00690020002D0020004D006F006400690066006900650064002000500065007200630065006E007400610067006500200074006F002000750073006500200054006F00740061006C004E005200510043006F0075006E0074002000610073002000640065006E006F006D0069006E00610074006F0072000D000A002D002D00200032003000310033002D00300032002D003100380020003A00200052006F006E0040004D0069006C0079006C00690020003A00200041006400640065006400200074006800650020006600690065006C006400200065006E006300720079007000740069006F006E00200063006F00640065000D000A002D002D00200032003000310033002D00300032002D003100380020003A00200052006F006E0040004D0069006C0079006C00690020003A0020005500700064006100740065006400200074006F0020004A006F00730068002700730020006D006F0073007400200075007000200074006F0020006400610074006500200063006F00640065000D000A002D002D00200032003000310033002D00300034002D003100390020003A00200052006F006E0040004D0069006C0079006C00690020003A002000410064006400650064002000490053004E0055004C004C00200063006800650063006B002000610072006F0075006E0064002000420053002E00530074006100740075007300500065007200630065006E0074006100670065004E0052004C00520051004400610079000D000A002D002D00200032003000310033002D00300034002D003100390020003A00200052006F006E0040004D0069006C0079006C00690020003A0020004100640064006500640020006C0069006D006900740065007200200074006F0020004E0069006E0065007400790044006100790043007500720073006F0072002E000D000A002D002D00200032003000310033002D00300034002D003200330020003A00200052006F006E0040004D0069006C0079006C00690020003A002000520065006D006F0076006500640020003900300020006400610079002000720075006E006E0069006E00670020006100760065007200610067006500200063006F00640065002E00200044006F006500730020006E006F0074002000610070007000650061007200200074006F00200062006500200064006900730070006C006100790065006400200069006E00200074006800650020004700550049002E0020000D000A002D002D0020003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D000D000A004300520045004100540045002000500052004F0043004500440055005200450020005B006500640064007300640062006F005D002E005B00550070006400610074006500420049005300530063006F007200650073005D000D000A005700490054004800200045004E004300520059005000540049004F004E000D000A00410053000D000A0042004500470049004E000D000A000D000A00090053004500540020004E004F0043004F0055004E00540020004F004E003B000D000A0009000D000A0009004400450043004C004100520045002000400070007700640020004E005600610072006300680061007200280031003000300029000D000A0009005300450054002000400070007700640020003D00200027006B004300750072006100500061007300730077006F00720064003100210027000D000A000D000A0009002D002D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D000D000A0009000D000A0009002D002D00440065007400650072006D0069006E00650020007400680065002000700065007200630065006E00740061006700650020006F00660020004E0052004C005200510020007000650072002000640061007900200061006E0064002000750070006400610074006500200074006800650020006600690065006C0064000D000A00090055005000440041005400450020006500640064007300640062006F002E00420049005300530075006D006D0061007200790020000D000A0009005300450054002000530074006100740075007300500065007200630065006E0074006100670065004E0052004C005200510044006100790020003D00200043004F004E005600450052005400280069006E00740065006700650072002C0020002800490053004E0055004C004C002800280043004F004E005600450052005400280064006500630069006D0061006C002C0020004E0052004C005200510043006F0075006E007400290020002F0020004E0055004C004C0049004600280043004F004E005600450052005400280064006500630069006D0061006C002C00200054006F00740061006C004E005200510043006F0075006E00740029002C003000290029002C0030002900290020002A002000310030003000290009000D000A000D000A0009002D002D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D000D000A000D000A0009002D002D00440065007400650072006D0069006E0065002000740068006500200053007400610074007500730020007000650072002000640061007900200061006E0064002000750070006400610074006500200074006800650020006600690065006C0064000D000A00090055005000440041005400450020006500640064007300640062006F002E00420049005300530075006D006D006100720079000D000A000900530045005400200053007400610074007500730044006100790020003D0020000D000A000900090045006E006300720079007000740042007900500061007300730050006800720061007300650028000D000A0009000900090040007000770064002C000D000A0009000900090043004F004E00560045005200540028006E00760061007200630068006100720028006D006100780029002C000D000A00090009000900430041005300450020000D000A0009000900090009005700480045004E002000530074006100740075007300500065007200630065006E0074006100670065004E0052004C005200510044006100790020003C0020003100300020005400480045004E002000310020002D002D005000610073007300650064000D000A0009000900090009005700480045004E002000530074006100740075007300500065007200630065006E0074006100670065004E0052004C005200510044006100790020003E003D00200031003000200041004E0044002000530074006100740075007300500065007200630065006E0074006100670065004E0052004C005200510044006100790020003C003100350020005400480045004E002000320020002D002D00500072006F0062006100740069006F006E000D000A0009000900090009005700480045004E002000530074006100740075007300500065007200630065006E0074006100670065004E0052004C005200510044006100790020003E003D0020003100350020005400480045004E0020003300200020002D002D004600610069006C000D000A00090009000900090045004C0053004500200030000D000A0009000900090045004E00440029002C000D000A0009000900090031002C000D000A0009000900090043004F004E00560045005200540028002000760061007200620069006E006100720079002C0020004D00650061007300750072006500440061007400650029000D000A000900090029000D000A000D000A0009002D002D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D003D000D000A0009000D000A0045004E004400
EXEC (@_)
GO
